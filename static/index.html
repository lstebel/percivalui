<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <title>Percival Detector</title>

    <!-- Bootstrap -->
    <link href="js/bootstrap-3.3.7-dist/css/bootstrap.css" rel="stylesheet">
    <link href="css/tabulator.css" rel="stylesheet">
    <link href="css/percival.css" rel="stylesheet">

  </head>
  <body style="padding-top: 30px;">
  
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container-fluid">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
			<a class="navbar-brand" rel="home" href="" title="Percival">
	        <img style="max-width:70px; margin-top: -7px;" src="/img/percival-logo.jpg">
		    </a>
          <div class="navbar-brand">Percival Detector</div>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <li class="home"><a href="#/home-view"> <span
                        class="glyphicon glyphicon-home"></span> <strong>Home</strong><span
                        class="label"></span></a></li>

                <li class="av navbar-nav"><a href="#/configuration-view"
                    class="dropdown-toggle" role="button" aria-expanded="false"> <strong>Configuration</strong>
                        <span class="label">Percival Setup</span>
                </a></li>
                <li class="av navbar-nav"><a href="#/status-view"
                    class="dropdown-toggle" role="button" aria-expanded="false"> <strong>Status</strong>
                        <span class="label">Live Monitoring</span>
                </a></li>
                <li class="av navbar-nav"><a href="#/control-view"
                    class="dropdown-toggle" role="button" aria-expanded="false"> <strong>Control</strong>
                        <span class="label">Control Channel Setpoints</span>
                </a></li>
                <li class="av navbar-nav"><a href="#/data-view"
                    class="dropdown-toggle" role="button" aria-expanded="false"> <strong>Data</strong>
                        <span class="label">Archived Data</span>
                </a></li>
            </ul>
        </div>
      </div>
    </nav>

<!-- HOME PAGE -->
	<div class="container-fluid home-view page">
		<div class="row fluid-row">		
			<div class="span3">
				<div class="well sidebar-nav-fixed">
					<div class="container-fluid">
						<div class="row sidebar-title">
							<h3>Server Status</h3>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-3">API Version:</div>
							<div id="api-version" class="col-xs-5 m-5 status vertical-align">&nbsp;</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-3">&nbsp;</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-3">Adapters Loaded:</div>
							<div id="api-adapters" class="col-xs-5 status vertical-align">&nbsp;</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-3">&nbsp;</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-3">Server Start Time:</div>
							<div id="server-start-time" class="col-xs-5 status vertical-align">&nbsp;</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-3">&nbsp;</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-3">Server Up Time:</div>
							<div id="server-up-time" class="col-xs-5 status vertical-align">&nbsp;</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-3">&nbsp;</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-3">Server Username:</div>
							<div id="server-username" class="col-xs-5 status vertical-align">&nbsp;</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-3">&nbsp;</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-3">Hardware Connection:</div>
							<div class="col-xs-5 status vertical-align">
								<table>
									<tr><td>Address:</td><td align="center" id="server-hw-address" width="150px"></td></tr>
									<tr><td>Port:</td><td align="center" id="server-hw-port"></td></tr>
									<tr><td>Connected:</td><td align="center" id="server-hw-connected"></td></tr>
									<tr><td></td><td align="center"><button id="server-hw-reconnect">Reconnect</button></td></tr>
								</table>
							</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-3">&nbsp;</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-3">Database Connection:</div>
							<div class="col-xs-5 status vertical-align">
								<table>
									<tr><td>Address:</td><td align="center" id="server-db-address" width="150px"></td></tr>
									<tr><td>Port:</td><td align="center" id="server-db-port"></td></tr>
									<tr><td>Name:</td><td align="center" id="server-db-name"></td></tr>
									<tr><td>Connected:</td><td align="center" id="server-db-connected"></td></tr>
									<tr><td></td><td align="center"><button id="server-db-reconnect">Reconnect</button></td></tr>
								</table>
							</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-3">&nbsp;</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-3">Auto-read Monitors (10 Hz):</div>
							<div class="col-xs-5 status vertical-align">
								<span id="server-ar-status"></span>
								<span><button id="server-ar-start">Start</button></span>
								<span><button id="server-ar-stop">Stop</button></span>
							</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-3">&nbsp;</div>
						</div>
					</div> <!-- container-fluid -->
				</div> <!--  well sidebar-nav-fixed -->
			</div> <!-- span3 -->
		</div> <!-- row fluid-row -->	
	</div> <!--  container-fluid -->

<!-- CONFIGURATION PAGE -->
	<div class="container-fluid configuration-view page">
		<div class="row fluid-row">
			<div class="span3">
				<div class="well sidebar-nav-fixed">
					<div class="container-fluid">
						<div class="row sidebar-title">
							<h3>Configuration</h3>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-2">Boards:</div>
							<div id="overall-boards" class="col-xs-7 m-7 status vertical-align">&nbsp;</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-2">&nbsp;</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-2">Controls:</div>
							<div id="overall-controls" class="col-xs-7 status vertical-align">&nbsp;</div>
  					</div>						
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-2">&nbsp;</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-2">Monitors:</div>
							<div id="overall-monitors" class="col-xs-7 status vertical-align">&nbsp;</div>
  					</div>						
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-2">&nbsp;</div>
						</div>
					</div> <!-- container-fluid -->
				</div> <!--  well sidebar-nav-fixed -->
			</div> <!-- span3 -->
		</div> <!-- row fluid-row -->	
	</div> <!--  container-fluid -->

	<div class="container-fluid status-view page">
		<div class="row fluid-row">
			<div class="span3">
				<div class="well sidebar-nav-fixed">
					<div class="container-fluid" id="stat-container">
						<div class="row sidebar-title">
							<h3>Status
								<small><div class="dropdown"><span class="btn-group">
									<button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown">
										<div id="status-group-name">Channels [ All ] </div></button>
									<button class="btn btn-default dropdown-toggle" type="button" data-toggle="dropdown"><span class="caret"></span>
									</button>
									<ul class="dropdown-menu" role="menu" id="status-group">
										<li role="presentation"><a role="menuitem" tabindex="-1" href="#">All</a></li>
									</ul>
									</span>
							</div></small></h3>
						</div>
					</div> <!-- container-fluid -->
				</div> <!--  well sidebar-nav-fixed -->
			</div> <!-- span3 -->
			
			
		</div> <!-- row fluid-row -->	
	</div> <!--  container-fluid -->

	<div class="container-fluid control-view page">
		<div class="row fluid-row">
			<div class="span3">
				<div class="well sidebar-nav-fixed">
					<div class="container-fluid">
						<div class="row sidebar-title">
							<h3>Control</h3>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-2">&nbsp;</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-2">Control Message Response:</div>
							<div class="col-xs-7 status vertical-align">
								<div id="ctrl-msg-response" class="panel panel-default">
									<div id="ctrl-resp-cmd" class="panel-heading">Command: </div>
									<table>
										<tr valign="top">
											<td style="padding:0 15px 0 15px;">Parameters:</td><td id="ctrl-resp-param"></td>
										</tr><tr>
											<td style="padding:0 15px 0 15px;">Execution Start Time:</td><td id="ctrl-resp-time"></td>
										</tr><tr>
											<td style="padding:0 15px 0 15px;">Response:</td><td id="ctrl-resp-success"></td>
										</tr><tr>
											<td style="padding:0 15px 0 15px;">Message:</td><td id="ctrl-resp-message"></td>
										</tr>
									</table>
									<!--<div class="panel-heading clearfix">
										<span class="panel-title pull-left">Status</span>
									</div>-->
								</div>
							</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-2">&nbsp;</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-2">Download Channel Settings:</div>
							<div class="col-xs-5 status vertical-align">
								<small><div class="dropdown">
									<span><button id="channel-settings-cmd">Execute</button></span>
								</div></small>
							</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-2">&nbsp;</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-2">Initialise Channels:</div>
							<div class="col-xs-5 status vertical-align">
								<small><div class="dropdown">
									<span><button id="server-init-cmd">Execute</button></span>
								</div></small>
							</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-2">&nbsp;</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-2">System Command:</div>
							<div class="col-xs-5 status vertical-align">
								<small><div class="dropdown">
									<select id="select-sys-cmd">
									</select>
									<span><button id="server-sys-cmd">Execute</button></span>
								</div></small>
							</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-2">&nbsp;</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-2">Set System Value:</div>
							<div class="col-xs-5 status vertical-align">
								<small><div class="dropdown">
									<select id="set-system-value">
									</select>
									<span><input type="text" id="server-set-system-val"></input></span>
									<span><button id="server-set-system-val-cmd">Execute</button></span>
								</div></small>
							</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-2">&nbsp;</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-2">Set Channel Value:</div>
							<div class="col-xs-5 status vertical-align">
								<small><div class="dropdown">
									<select id="control-set-channel">
									</select>
									<span><input type="text" id="server-set-channel-val"></input></span>
									<span><button id="server-set-channel-cmd">Execute</button></span>
								</div></small>
							</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-2">&nbsp;</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-2">Apply Set Point:</div>
							<div class="col-xs-5 status vertical-align">
								<small><div class="dropdown">
									<select id="select-set-point">
									</select>
									<span><button id="server-set-point-cmd">Execute</button></span>
								</div></small>
							</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-2">&nbsp;</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-2">Scan Set Points:</div>
							<div class="col-xs-5 status vertical-align">
								<small>Initial setpoint:<div class="dropdown">
									<select id="scan-set-point-start">
									</select>
								</div></small>
								<small>Final setpoint:<div class="dropdown">
									<select id="scan-set-point-end">
									</select>
								</div></small>
								<span>Number of steps:<input type="text" id="scan-sp-steps" value="10"></input></span>
								<span>Dwell time (ms):<input type="text" id="scan-sp-dwell" value="1000"></input></span>
								<span><button id="server-scan-set-point-cmd">Execute</button></span>
								<span><button data-toggle="modal" data-target="#sp-scan-modal">View Details</button></span>
							</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-2">&nbsp;</div>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-2">Upload Configuration File:</div>
							<div class="col-xs-5 status vertical-align">
								<small>
									<input type="file" id="select-config-file" size="500">
									</input>
									<div class="dropdown">
									<select id="select-config">
										<option>system_settings</option>
										<option>chip_readout_settings</option>
										<option>clock_settings</option>
										<option>sensor_dacs</option>
										<option>sensor_configuration</option>
										<option>sensor_calibration</option>
										<option>sensor_debug</option>
										<option>setpoints</option>
										<option>control_groups</option>
										<option>monitor_groups</option>
									</select>
									<span><button id="server-config-cmd">Execute</button></span>
									</div>
								</small>
								<textarea rows="20" cols="80" id="config-display"></textarea>
							</div>
						</div>
					</div> <!-- container-fluid -->
				</div> <!--  well sidebar-nav-fixed -->
			</div> <!-- span3 -->


		</div> <!-- row fluid-row -->
	</div> <!--  container-fluid -->

	<div class="container-fluid data-view page">
		<div class="row fluid-row">
			<div class="span3">
				<div class="well sidebar-nav-fixed">
					<div class="container-fluid">
						<div class="row sidebar-title">
							<h3>Data Logging</h3>
						</div>
						<div class="row sidebar-row vertical-align">
							<div class="col-xs-1">&nbsp;</div>
							<div class="col-xs-12 status"><iframe width="100%" height="700px" src="http://127.0.0.1:3000/dashboard/db/first-dashboard?orgId=1&from=now-1h&to=now"></iframe></div>
	  					</div>
					</div> <!-- container-fluid -->
				</div> <!--  well sidebar-nav-fixed -->
			</div> <!-- span3 -->
			
			
		</div> <!-- row fluid-row -->	
	</div> <!--  container-fluid -->



	<div class="modal fade" id="sp-scan-modal" role="dialog">
	    <div class="modal-dialog" style="overflow-y: scroll; max-height:85%;  margin-top: 50px; margin-bottom:50px;">
    	    <div class="modal-content">
        	    <div class="modal-header">
            	    <h3 class="modal-title">Scanning Status</h3>
            	</div>
	            <div class="modal-body">
					<table>
						<tr valign="top">
							<td style="padding:0 15px 0 15px;">Scanning:</td><td id="sp-scan-scanning"></td>
						</tr><tr>
							<td style="padding:0 15px 0 15px;">Index:</td><td id="sp-scan-index"></td>
						</tr><tr>
							<td style="padding:0 15px 0 15px;">Scan:</td><td id="sp-scan-scanpoints"></td>
						</tr>
					</table>
				</div>
			</div>
		</div>
	</div>

  
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="js/jquery-3.2.1.min.js" type="text/javascript"></script>
    <script src="js/jquery-ui.min.js" type="text/javascript"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap-3.3.7-dist/js/bootstrap.min.js" type="text/javascript"></script>
    <script src="js/tabulator.js" type="text/javascript"></script>
    <script src="js/percival.js" type="text/javascript"></script>

</body>
</html>

